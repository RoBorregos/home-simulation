<launch>
    <master 
        auto="start"
    />
    <!-- Run the map server --> 
    <arg name="map_file" default="$(find nav_main)/maps/Layout2020HM01.yaml"/>
    <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_file)"/>
    <rosparam file="$(arg map_file)" command="load" ns="map" />

    <arg name="initial_pose_x" default="0.0"/> 
    <arg name="initial_pose_y" default="0.0"/> 
    <arg name="initial_pose_a" default="0.0"/>
          <!-- Generate PointCloud -->
  <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />
  <node pkg="nodelet" type="nodelet" name="nodelet1"
        args="load depth_image_proc/point_cloud_xyz nodelet_manager">
    <remap from="camera_info" to="/hsrb/head_rgbd_sensor/depth_registered/camera_info"/>
    <remap from="image_rect" to="/hsrb/head_rgbd_sensor/depth_registered/image_raw"/>
    <remap from="points" to="/hsrb/head_rgbd_sensor/depth_registered/points"/>
  </node>
    <include file="$(find nav_main)/include/imu/amcl.launch.xml">
        <arg name="initial_pose_x" value="$(arg initial_pose_x)"/>
        <arg name="initial_pose_y" value="$(arg initial_pose_y)"/>
        <arg name="initial_pose_a" value="$(arg initial_pose_a)"/>
    </include>
    <include file="$(find nav_main)/include/imu/teb_move_base.launch"/>

  <!-- Generate PointCloud -->
    <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />
    <node pkg="nodelet" type="nodelet" name="nodelet1"
          args="load depth_image_proc/point_cloud_xyz nodelet_manager">
      <remap from="camera_info" to="/hsrb/head_rgbd_sensor/depth_registered/camera_info"/>
      <remap from="image_rect" to="/hsrb/head_rgbd_sensor/depth_registered/image_raw"/>
      <remap from="points" to="/hsrb/head_rgbd_sensor/depth_registered/points"/>
    </node>

 </launch>